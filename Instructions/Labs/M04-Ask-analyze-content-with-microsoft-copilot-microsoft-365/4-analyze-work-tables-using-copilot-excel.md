# 使用 Excel 中的 Microsoft 365 Copilot 分析和处理表

如果不确定如何为新列编写公式，借助 Microsoft 365 Copilot 可以快速添加基于数据的公式的新列。

1. 将数据格式化为表后，选择功能区中的 **Copilot** 按钮。

1. 选择 **“添加公式列”** 或 **“显示公式列的建议”**。 还可以通过输入自己的语言表述，来描述想要添加的列。

1. Copilot 提供了公式建议，并为每个公式说明其工作原理。 通过选择 **“解释公式”** 来查看说明。

1. 选择“插入列”，将公式列添加到表中。

> [!IMPORTANT]
> 与任何 AI 生成的内容一样，请务必查看、编辑和验证 Copilot 为你创建的任何内容。

## 我们开始撰写

首先，下载 **_[Fabrikam Q1 marketing campaigns.xlsx](https://go.microsoft.com/fwlink/?linkid=2269124)_**，如果尚未保存，请将该文件保存到 **OneDrive 文件夹**中。

在 Excel 中打开电子表格，然后通过选择功能区“**开始**”选项卡中的 Copilot 图标打开 **Copilot** 窗格。输入下面的提示，然后继续操作。

> [!NOTE]
> 启动撰写提示：
>
> _“建议公式列。”_

在此简单提示中，你将从基本“**目标**”开始：_用公式创建新列_。 但是，没有足够的详细信息来确定公式应计算的内容。  

| 元素 | 示例 |
| :------ | :------- |
| **基本提示：** 从一个“**目标**”开始 | **_建议公式列。_** |
| **良好提示：** 添加“**上下文**” | 添加“**上下文**”有助于 Copilot 了解公式应计算的内容。 _“对于列 J，确定每个市场活动的参与率。”_ |
| **更好的提示：** 指定“**来源**” | 此提示的“**来源**”是计算所需的特定列。 _“...使用‘参与用户’和‘目标用户总数’中的值。”_ |
| **最佳提示：** 设置明确的“**预期**” | 添加“**期望**”有助于 Copilot 正确构建公式。 _“确保公式将‘参与用户数’除以‘目标用户总数’，并将结果的格式设置为百分比。”_ |

> [!NOTE]  
> **精心制作的提示：**  
>
> _建议列 J 的公式，以计算每个市场活动的参与率。使用“参与用户”和“目标用户总数”中的值。确保公式将“参与用户数”除以“目标用户总数”，并将结果的格式设置为百分比。_  

![在 Excel 中使用 Copilot 创建提示结果的屏幕截图。](../media/ask_copilot-explain-formula-results-excel.png)

有了此提示中的**目标**、**上下文**、**来源**和**期望**，Copilot 就具备了为你提供可靠答案所需的所有信息。

## 浏览更多

将这些提示用作起点。 复制和修改它们以满足自己的需求。

- 计算新列中每个产品的总成本。

- 添加一个列，用于计算 2022 年每个营销活动的总利润。

- 添加一个列，用于计算产品启动事件后的天数。

有关详细信息，请参阅[在 Excel 中使用 Copilot 生成公式列](https://support.microsoft.com/office/generate-formula-columns-with-copilot-in-excel-d866d926-9791-4e5f-be2a-c6dd9e587a47)。
